---
import Button from "../common/Button.astro";
import Icon from "../common/Icon.astro";
import Logo from "./Logo.astro";
import Nav from "./Nav.astro";
import texts from "@/utils/texts.json";

interface NavAnchor {
  id: string;
  label: string;
}

const headerTexts = texts.header;
const { navAnchors } = Astro.props;

const NAVIGATION = navAnchors 
  ? navAnchors.map((anchor: NavAnchor) => ({ name: anchor.label, href: `#${anchor.id}`, isAnchor: true }))
  : [
    { name: headerTexts.nav.home, href: "/" },
    { name: headerTexts.nav.about, href: "/#about" },
    { name: headerTexts.nav.services, href: "/#services" },
    { name: headerTexts.nav.contact, href: "/#contact" },
    { name: headerTexts.nav.faq, href: "/#faq" },
  ];
---

<!-- 
  OPTIMIZED HEADER HEIGHTS for 100vh Compliance:
  Contact Bar: py-2 (~2rem total with content)
  Main Nav: Mobile 3.5rem + Tablet 4rem + Desktop 4.5rem
  Total Header: ~5-6rem depending on screen size
  This ensures header + hero section fit within 100vh
-->
<header>  <!-- Top Contact Bar with optimized padding -->
  <div class="bg-ag-neutral-50 text-ag-body-text font-ag-body-text flex flex-col md:flex-row md:justify-between items-center mx-auto py-2 px-4">
    <div class="flex flex-col sm:flex-row gap-2 sm:gap-4">      <a
        href="https://maps.app.goo.gl/UbA5eCbGWvF2pyPu9"
        class="hidden sm:flex items-center gap-2 text-center sm:text-left hover:text-primary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded-sm min-h-[44px] px-2"
        aria-label="Visit our location on Google Maps"
      >
        <Icon
          icons={[{ name: "mapMarker" }]}
          size="small"
          variant="default"
        />
        {headerTexts.address}
      </a>      <a
        href={`tel:${headerTexts.phone}`}
        class="flex items-center gap-2 text-center sm:text-left hover:text-primary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded-sm min-h-[44px] px-2"
        aria-label={`Call us at ${headerTexts.phone}`}
      >
        <Icon
          icons={[{ name: "phone", href: `tel:${headerTexts.phone}` }]}
          size="small"
          variant="default"
        />
        {headerTexts.phone}
      </a>
    </div>
    <div
      class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-6 rtl:space-x-reverse mt-2 md:mt-0"
    >
      <div class="flex items-center gap-2">
        <Icon icons={[{ name: "clock" }]} size="small" variant="default" />
        {headerTexts.schedule}
      </div>
      <ul class="hidden sm:flex">
        <li class="space-x-2">
          <Icon
            icons={[
              { name: "facebook", href: headerTexts.socialLinks.facebook },
              { name: "twitter", href: headerTexts.socialLinks.twitter },
              {
                name: "instagram",
                href: headerTexts.socialLinks.instagram,
              },
            ]}
            size="small"
            variant="default"
          />
        </li>
      </ul>
    </div>
  </div>
  <!-- Main Navigation -->
  <nav class="bg-white border-b">
    <div class="max-w-7xl mx-auto px-2 sm:px-4 md:px-6">
      <div class="flex items-center justify-between min-h-[3.5rem] md:min-h-[4rem] lg:min-h-[4.5rem]">        <!-- Logo section -->
        <div class="flex-shrink-0 flex items-center py-2">
          <a 
            href="/" 
            class="block focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded-sm min-h-[44px] p-2 -m-2"
            aria-label="Go to homepage"
          >
            <Logo class="h-8 md:h-10 lg:h-12 w-auto" color="dark" />
          </a>
        </div>

        <!-- Navigation Links - Desktop -->
        <div class="hidden md:flex items-center justify-center px-4">
          <Nav links={NAVIGATION} />
        </div>

        <!-- Button and Mobile menu -->
        <div class="flex items-center gap-2 md:gap-3 shrink-0">
          <Button 
            class="hidden md:inline-flex items-center text-sm lg:text-base py-2 px-3 lg:px-4 min-w-[120px] lg:min-w-[140px]" 
            variant="primary" 
            size="medium"
            href={`tel:${headerTexts.phone}`}
          >
            {headerTexts.buttonText}
          </Button>          <!-- Mobile menu button -->
          <button
            data-collapse-toggle="navbar-cta"
            type="button"
            class="inline-flex items-center justify-center p-3 text-deep-blue rounded-lg md:hidden hover:bg-ag-neutral-100 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200 min-h-[44px] min-w-[44px]"
            aria-controls="navbar-cta"
            aria-expanded="false"
            aria-label="Open navigation menu"
          >
            <span class="sr-only">Open main menu</span>
            <svg
              class="w-6 h-6"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              />
            </svg>
          </button>
        </div>
      </div>

      <!-- Mobile menu -->
      <div class="md:hidden" id="navbar-cta">
        <div class="px-2 pt-2 pb-3 space-y-1">
          <Nav links={NAVIGATION} />
          <div class="mt-4">
            <Button 
              class="w-full text-center justify-center py-2"
              variant="primary" 
              size="medium"
              href={`tel:${headerTexts.phone}`}
            >
              {headerTexts.buttonText}
            </Button>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
