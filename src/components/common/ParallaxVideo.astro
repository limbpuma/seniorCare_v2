---
import Section from "./Section.astro";
import TextBlock from "./TextBlock.astro";
import ParallaxMedia from "./ParallaxMedia.astro";

const { subtitle, title, description, videoSrc, posterSrc, alignment, textColor, buttonHref, buttonSize, buttonVariant, buttonText } = Astro.props;
---

<!-- 
  VIEWPORT OPTIMIZATION: 
  Hero section height is calculated to fit within 100vh minus header height
  Mobile: ~5rem header = calc(100vh - 5rem)
  Tablet: ~5.5rem header = calc(100vh - 5.5rem) 
  Desktop: ~6rem header = calc(100vh - 6rem)
  This ensures no scroll is needed to see main content on landing
-->
<Section
  padding="large"
  width="full"
  height="100%"
  id="hero-parallax-section"
  class="relative overflow-hidden motion-safe:parallax-enabled hero-optimized h-full w-full"
>
  <!-- Accessibility-aware background with reduced motion support -->
  <div class="absolute inset-0 w-full h-full parallax-container motion-reduce:opacity-50">
    <ParallaxMedia 
      type="video" 
      src={videoSrc}
      posterSrc={posterSrc}
    />
    <!-- Enhanced overlay for better text contrast -->
    <div 
      class="absolute inset-0 bg-gradient-to-r from-black/60 via-black/30 to-transparent z-[1]"
      aria-hidden="true"
    ></div>  </div>
    <!-- Content container with improved positioning -->
  <div class="relative z-10 w-full max-w-7xl mx-auto h-full flex items-center justify-center lg:justify-start px-4 sm:px-6 lg:px-8">
    <div class="w-full max-w-3xl lg:max-w-none text-center lg:text-left lg:w-2/5">
      <TextBlock
        subtitle={subtitle}
        title={title}
        descriptionBold={description}
        alignment={alignment}
        textColor={textColor}
        buttonText={buttonText}
        buttonVariant={buttonVariant}
        buttonSize={buttonSize}
        buttonHref={buttonHref}
      />
    </div>
  </div>
  
  <!-- Screen reader announcement for video content -->
  <div class="sr-only" role="status" aria-live="polite">
    Video background showing professional senior care services
  </div>
</Section>

<style>
/* Hero optimization for flexbox layout */
.hero-optimized {
  /* Take all available space in flex container */
  height: 100%;
  width: 100%;
  max-height: 100%;
  overflow: hidden;
  
  /* Ensure it fills the available viewport space */
  min-height: 300px; /* Minimum height for content readability */
  
  /* Ensure proper stacking context */
  position: relative;
  z-index: 1;
}

/* Ensure content is properly positioned within the hero */
.hero-optimized > div {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Mobile specific optimizations */
@media (max-width: 768px) {
  .hero-optimized {
    min-height: 400px;
  }
}

/* Reduced motion accessibility */
@media (prefers-reduced-motion: reduce) {
  .hero-optimized {
    min-height: 60vh; /* Ensure content is visible when animations are disabled */
  }
}
</style>
